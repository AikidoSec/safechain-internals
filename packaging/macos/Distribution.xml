<?xml version="1.0" encoding="utf-8"?>
<installer-gui-script minSpecVersion="2">
    <title>SafeChain Agent</title>
    <organization>com.aikidosecurity</organization>
    <domains enable_localSystem="true"/>
    <options customize="never" require-scripts="true" rootVolumeOnly="true" />
    
    <!-- Define documents displayed at various steps -->
    <welcome file="welcome.html" mime-type="text/html" />
    <license file="license.txt" mime-type="text/plain" />
    <conclusion file="conclusion.html" mime-type="text/html" />
    
    <!-- Background image (optional, uncomment if you have one) -->
    <!-- <background file="background.png" mime-type="image/png" alignment="topleft" scaling="none"/> -->
    
    <!-- Define the installer choices -->
    <choices-outline>
        <line choice="default">
            <line choice="com.aikidosecurity.safechainagent"/>
        </line>
    </choices-outline>
    
    <choice id="default"/>
    <choice id="com.aikidosecurity.safechainagent" visible="false">
        <pkg-ref id="com.aikidosecurity.safechainagent"/>
    </choice>
    
    <pkg-ref id="com.aikidosecurity.safechainagent" version="VERSION_PLACEHOLDER" onConclusion="none">SafeChainAgent.ARCH_PLACEHOLDER.pkg</pkg-ref>
    
    <!-- Requirements -->
    <installation-check script="pm_install_check();"/>
    <script>
    <![CDATA[
        function pm_install_check() {
            if(!(system.compareVersions(system.version.ProductVersion, '10.15') >= 0)) {
                my.result.title = 'Unable to install';
                my.result.message = 'SafeChain Agent requires macOS 10.15 or later.';
                my.result.type = 'Fatal';
                return false;
            }
            return true;
        }
    ]]>
    </script>
</installer-gui-script>
