use std::convert::Infallible;

use rama::{
    Service,
    http::{
        Request, Response,
        service::web::{
            Router,
            response::{IntoResponse, Json},
        },
    },
};

use crate::firewall::malware_list::{ListDataEntry, PackageVersion, Reason};

pub(super) fn web_svc() -> impl Service<Request, Output = Response, Error = Infallible> {
    Router::new().with_get("malware_vscode.json", malware_vscode)
}

async fn malware_vscode() -> impl IntoResponse {
    Json([ListDataEntry {
        package_name: "pythoner.pythontheme".to_owned(),
        version: PackageVersion::Semver(semver::Version::new(2, 7, 5)),
        reason: Reason::Malware,
    }])
}
