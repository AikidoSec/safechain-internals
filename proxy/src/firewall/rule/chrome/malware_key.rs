use crate::firewall::malware_list::{ListDataEntry, MalwareListEntryFormatter};

pub(super) struct ChromeMalwareListEntryFormatter;

impl MalwareListEntryFormatter for ChromeMalwareListEntryFormatter {
    fn format(&self, entry: &ListDataEntry) -> String {
        // Example value from malware list:
        //   "Malicious Extension - Chrome Web Store@lajondecmobodlejlcjllhojikagldgd"
        let raw = entry.package_name.trim();
        let extension_id = raw.rsplit_once('@').map(|(_, id)| id).unwrap_or(raw);
        extension_id.to_ascii_lowercase()
    }
}
